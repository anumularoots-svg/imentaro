<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iMentora â€” Complete AWS Setup Guide</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Outfit:wght@300;400;500;600;700;800&display=swap');
  :root{--bg:#0a0e17;--surface:#111827;--surface2:#1a2234;--border:#1e293b;--accent:#06b6d4;--accent2:#8b5cf6;--accent3:#f59e0b;--accent4:#10b981;--accent5:#ef4444;--accent6:#ec4899;--text:#e2e8f0;--text-dim:#94a3b8;--text-bright:#f8fafc}
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);line-height:1.7}
  .container{max-width:1000px;margin:0 auto;padding:20px}
  .hero{text-align:center;padding:40px 20px 20px}
  .hero h1{font-size:2.2rem;font-weight:800;background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  .hero .sub{font-size:0.92rem;color:var(--text-dim);margin-top:4px}

  /* Step navigation */
  .step-nav{display:flex;overflow-x:auto;gap:2px;padding:10px;position:sticky;top:0;z-index:100;background:var(--bg);border-bottom:1px solid var(--border)}
  .sn{padding:8px 14px;border-radius:6px;border:1px solid var(--border);background:var(--surface);color:var(--text-dim);cursor:pointer;font-size:0.72rem;font-weight:500;white-space:nowrap;font-family:'Outfit',sans-serif;transition:all .3s}
  .sn:hover{border-color:var(--accent);color:var(--text)}
  .sn.active{background:linear-gradient(135deg,rgba(6,182,212,0.15),rgba(139,92,246,0.15));border-color:var(--accent);color:var(--text-bright)}
  .sn .num{display:inline-block;width:18px;height:18px;border-radius:50%;background:var(--border);text-align:center;line-height:18px;font-size:0.6rem;margin-right:4px}
  .sn.active .num{background:var(--accent);color:var(--bg)}
  .sn.done .num{background:var(--accent4);color:var(--bg)}

  .step{display:none}.step.active{display:block;animation:fadeIn .3s ease}
  @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1}}

  .sh{display:flex;align-items:center;gap:14px;margin-bottom:24px;padding-bottom:14px;border-bottom:1px solid var(--border)}
  .sh-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.3rem;flex-shrink:0}
  .sh h2{font-size:1.3rem;font-weight:700;color:var(--text-bright)}
  .sh p{font-size:0.8rem;color:var(--text-dim);margin-top:2px}
  .sh .time{font-size:0.7rem;color:var(--accent3);background:rgba(245,158,11,0.1);padding:2px 8px;border-radius:4px}

  .cmd{background:#0d1117;border:1px solid var(--border);border-radius:10px;overflow:hidden;margin:12px 0}
  .cmd-h{display:flex;justify-content:space-between;align-items:center;padding:6px 14px;background:rgba(30,41,59,0.5);border-bottom:1px solid var(--border)}
  .cmd-h span{font-family:'JetBrains Mono',monospace;font-size:0.7rem;color:var(--text-dim)}
  .cmd-h .l{font-size:0.65rem;padding:2px 6px;border-radius:3px;background:rgba(6,182,212,0.1);color:var(--accent)}
  .cmd-b{padding:12px;font-family:'JetBrains Mono',monospace;font-size:0.72rem;line-height:1.7;color:#e6edf3;overflow-x:auto;white-space:pre}
  .cm{color:#6b7b8d}.kw{color:#ff7b72}.st{color:#a5d6ff}.vl{color:#79c0ff}

  .note{border-radius:10px;padding:14px 16px;margin:12px 0;font-size:0.82rem}
  .note.warn{background:rgba(245,158,11,0.08);border:1px solid rgba(245,158,11,0.2);color:var(--text-dim)}
  .note.warn strong{color:var(--accent3)}
  .note.info{background:rgba(6,182,212,0.06);border:1px solid rgba(6,182,212,0.15);color:var(--text-dim)}
  .note.info strong{color:var(--accent)}
  .note.danger{background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);color:var(--text-dim)}
  .note.danger strong{color:var(--accent5)}
  .note.ok{background:rgba(16,185,129,0.06);border:1px solid rgba(16,185,129,0.15);color:var(--text-dim)}
  .note.ok strong{color:var(--accent4)}

  .card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:18px;margin:12px 0}
  .card h4{font-size:0.9rem;font-weight:600;color:var(--text-bright);margin-bottom:8px}
  .card .d{font-size:0.78rem;color:var(--text-dim);padding:2px 0 2px 14px;position:relative}
  .card .d::before{content:'â€º';position:absolute;left:0;opacity:.5}

  .tbl{width:100%;border-collapse:collapse;margin:12px 0}
  .tbl th,.tbl td{padding:8px 12px;text-align:left;font-size:0.78rem;border-bottom:1px solid var(--border)}
  .tbl th{font-weight:600;color:var(--text-dim);font-size:0.7rem;text-transform:uppercase;letter-spacing:.5px;background:var(--surface2)}

  .tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:0.68rem;font-weight:600}
  .tag.g{background:rgba(16,185,129,0.15);color:var(--accent4)}
  .tag.y{background:rgba(245,158,11,0.15);color:var(--accent3)}
  .tag.r{background:rgba(239,68,68,0.15);color:var(--accent5)}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:768px){.grid2{grid-template-columns:1fr}}

  .next-btn{display:inline-block;padding:10px 24px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;margin-top:16px;font-family:'Outfit',sans-serif;font-size:0.85rem}
  .next-btn:hover{opacity:0.9}
</style>
</head>
<body>

<div class="hero">
  <h1>iMentora â€” Complete AWS Setup Guide</h1>
  <p class="sub">Step-by-step from zero to running infrastructure on AWS</p>
</div>

<div class="step-nav" id="nav">
  <button class="sn active" data-s="0"><span class="num">0</span>Prerequisites</button>
  <button class="sn" data-s="1"><span class="num">1</span>Backend Setup</button>
  <button class="sn" data-s="2"><span class="num">2</span>Clone & Configure</button>
  <button class="sn" data-s="3"><span class="num">3</span>Deploy Infra</button>
  <button class="sn" data-s="4"><span class="num">4</span>Post-Deploy</button>
  <button class="sn" data-s="5"><span class="num">5</span>Install K8s Tools</button>
  <button class="sn" data-s="6"><span class="num">6</span>GitHub CI/CD</button>
  <button class="sn" data-s="7"><span class="num">7</span>Next Steps</button>
</div>

<!-- â•â•â• STEP 0: PREREQUISITES â•â•â• -->
<div class="step active container" id="s0">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(6,182,212,0.15);color:var(--accent)">ğŸ“‹</div>
    <div>
      <h2>Step 0 â€” Prerequisites</h2>
      <p>Install these tools on your workstation before proceeding</p>
      <span class="time">â± 15 minutes</span>
    </div>
  </div>

  <div class="card">
    <h4>Required Tools</h4>
    <div class="d"><strong>AWS CLI v2</strong> â€” Interact with AWS from terminal</div>
    <div class="d"><strong>Terraform >= 1.7.0</strong> â€” Infrastructure as Code</div>
    <div class="d"><strong>kubectl</strong> â€” Kubernetes cluster management</div>
    <div class="d"><strong>Git</strong> â€” Version control</div>
    <div class="d"><strong>helm</strong> â€” Kubernetes package manager (for later steps)</div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Install on Ubuntu/Linux</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># 1. AWS CLI v2</span>
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip && sudo ./aws/install
aws --version

<span class="cm"># 2. Terraform</span>
sudo apt-get update && sudo apt-get install -y gnupg software-properties-common
wget -O- https://apt.releases.hashicorp.com/gpg | \
  gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] \
  https://apt.releases.hashicorp.com $(lsb_release -cs) main" | \
  sudo tee /etc/apt/sources.list.d/hashicorp.list
sudo apt update && sudo apt install terraform
terraform version

<span class="cm"># 3. kubectl</span>
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
kubectl version --client

<span class="cm"># 4. Helm</span>
curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
helm version</div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Configure AWS CLI</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Configure with your IAM user credentials</span>
aws configure
<span class="cm"># AWS Access Key ID: [your-key]</span>
<span class="cm"># AWS Secret Access Key: [your-secret]</span>
<span class="cm"># Default region: ap-south-1</span>
<span class="cm"># Default output: json</span>

<span class="cm"># Verify access</span>
aws sts get-caller-identity
<span class="cm"># Should show: Account: 664418964913</span></div>
  </div>

  <div class="note warn">
    <strong>âš ï¸ IAM Permissions:</strong> The IAM user/role running Terraform needs <code>AdministratorAccess</code> policy (or specific permissions for VPC, EKS, RDS, DocumentDB, ElastiCache, IAM, KMS, CloudWatch, Secrets Manager). For initial setup, admin access is simplest.
  </div>

  <button class="next-btn" onclick="goStep(1)">Next: Backend Setup â†’</button>
</div>

<!-- â•â•â• STEP 1: BACKEND SETUP â•â•â• -->
<div class="step container" id="s1">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(139,92,246,0.15);color:var(--accent2)">ğŸ—„ï¸</div>
    <div>
      <h2>Step 1 â€” Create Terraform Backend</h2>
      <p>S3 bucket for state + DynamoDB for locking (one-time setup)</p>
      <span class="time">â± 5 minutes</span>
    </div>
  </div>

  <div class="note info">
    <strong>Why?</strong> Terraform state tracks what resources exist. Storing state in S3 with DynamoDB locking prevents team members from running conflicting changes simultaneously. This must be created BEFORE <code>terraform init</code>.
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Create S3 Bucket + DynamoDB Table</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># â”€â”€â”€ S3 Bucket for Terraform State â”€â”€â”€</span>
aws s3 mb s3://imentora-terraform-state-664418964913 --region ap-south-1

<span class="cm"># Enable versioning (recover from bad state)</span>
aws s3api put-bucket-versioning \
  --bucket imentora-terraform-state-664418964913 \
  --versioning-configuration Status=Enabled

<span class="cm"># Enable encryption</span>
aws s3api put-bucket-encryption \
  --bucket imentora-terraform-state-664418964913 \
  --server-side-encryption-configuration '{
    "Rules": [{"ApplyServerSideEncryptionByDefault": {"SSEAlgorithm": "AES256"}}]
  }'

<span class="cm"># Block public access</span>
aws s3api put-public-access-block \
  --bucket imentora-terraform-state-664418964913 \
  --public-access-block-configuration \
  BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true

<span class="cm"># â”€â”€â”€ DynamoDB Table for State Locking â”€â”€â”€</span>
aws dynamodb create-table \
  --table-name imentora-terraform-lock \
  --attribute-definitions AttributeName=LockID,AttributeType=S \
  --key-schema AttributeName=LockID,KeyType=HASH \
  --billing-mode PAY_PER_REQUEST \
  --region ap-south-1

<span class="cm"># â”€â”€â”€ Verify â”€â”€â”€</span>
aws s3 ls | grep imentora
aws dynamodb describe-table --table-name imentora-terraform-lock --query 'Table.TableStatus'</div>
  </div>

  <div class="note ok">
    <strong>âœ… Expected output:</strong> S3 bucket shows in list, DynamoDB table status is "ACTIVE"
  </div>

  <button class="next-btn" onclick="goStep(2)">Next: Clone & Configure â†’</button>
</div>

<!-- â•â•â• STEP 2: CLONE & CONFIGURE â•â•â• -->
<div class="step container" id="s2">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(245,158,11,0.15);color:var(--accent3)">âš™ï¸</div>
    <div>
      <h2>Step 2 â€” Clone Repo & Set Secrets</h2>
      <p>Get the infrastructure code and configure sensitive values</p>
      <span class="time">â± 10 minutes</span>
    </div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Clone and review</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Clone the infrastructure repo</span>
git clone https://github.com/lancier-tech-org/IMENTORA-infra.git
cd IMENTORA-infra

<span class="cm"># Review the structure</span>
find . -type f -name "*.tf" | head -30

<span class="cm"># Review dev configuration values</span>
cat environments/dev/terraform.tfvars</div>
  </div>

  <div class="note danger">
    <strong>ğŸ”‘ CRITICAL: Set sensitive variables as environment variables.</strong> NEVER put passwords or API keys in terraform.tfvars or any committed file.
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Set sensitive variables</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># â”€â”€â”€ Generate strong passwords â”€â”€â”€</span>
export TF_VAR_rds_username="aboradmin"
export TF_VAR_rds_password="$(openssl rand -base64 24)"
export TF_VAR_docdb_username="docdbadmin"
export TF_VAR_docdb_password="$(openssl rand -base64 24)"
export TF_VAR_redis_auth_token="$(openssl rand -base64 32)"

<span class="cm"># â”€â”€â”€ API Keys (use your NEW rotated keys!) â”€â”€â”€</span>
export TF_VAR_openai_api_key="sk-proj-YOUR-NEW-ROTATED-KEY"
export TF_VAR_groq_api_key="gsk_YOUR-NEW-ROTATED-KEY"

<span class="cm"># â”€â”€â”€ SAVE THESE PASSWORDS! â”€â”€â”€</span>
<span class="cm"># Store in a password manager immediately</span>
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘ SAVE THESE CREDENTIALS SECURELY!     â•‘"
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo "â•‘ RDS Username: $TF_VAR_rds_username"
echo "â•‘ RDS Password: $TF_VAR_rds_password"
echo "â•‘ DocDB Username: $TF_VAR_docdb_username"
echo "â•‘ DocDB Password: $TF_VAR_docdb_password"
echo "â•‘ Redis Token: $TF_VAR_redis_auth_token"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</div>
  </div>

  <button class="next-btn" onclick="goStep(3)">Next: Deploy Infrastructure â†’</button>
</div>

<!-- â•â•â• STEP 3: DEPLOY â•â•â• -->
<div class="step container" id="s3">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(16,185,129,0.15);color:var(--accent4)">ğŸš€</div>
    <div>
      <h2>Step 3 â€” Deploy Dev Infrastructure</h2>
      <p>Initialize, plan, and apply Terraform</p>
      <span class="time">â± 20-25 minutes</span>
    </div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Initialize Terraform</span><span class="l">Bash</span></div>
    <div class="cmd-b">cd environments/dev

<span class="cm"># Initialize â€” downloads providers, configures backend</span>
terraform init

<span class="cm"># Expected output:</span>
<span class="cm"># Terraform has been successfully initialized!</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Plan â€” Review what will be created</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Generate execution plan</span>
terraform plan -out=tfplan

<span class="cm"># Review the output carefully!</span>
<span class="cm"># Expected: ~50-60 resources to create</span>
<span class="cm"># Including: VPC, subnets, EKS cluster, node groups,</span>
<span class="cm">#            RDS, DocumentDB, ElastiCache, IAM roles, etc.</span></div>
  </div>

  <div class="note warn">
    <strong>âš ï¸ Review the plan output carefully before applying.</strong> Look for any unexpected destroys or changes. The plan should show only "add" operations on first run.
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Apply â€” Create all resources</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Apply the plan</span>
terraform apply tfplan

<span class="cm"># This takes 15-25 minutes. Key timings:</span>
<span class="cm"># - VPC + subnets: ~2 minutes</span>
<span class="cm"># - EKS cluster: ~10 minutes (longest)</span>
<span class="cm"># - Node groups: ~5 minutes each</span>
<span class="cm"># - RDS: ~5 minutes</span>
<span class="cm"># - DocumentDB: ~5 minutes</span>
<span class="cm"># - ElastiCache: ~5 minutes</span>

<span class="cm"># When complete:</span>
<span class="cm"># Apply complete! Resources: 55 added, 0 changed, 0 destroyed.</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>View outputs</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Get important values</span>
terraform output

<span class="cm"># Key outputs you'll need:</span>
terraform output eks_cluster_name
terraform output ecr_repository_url
terraform output configure_kubectl
terraform output github_actions_role_arn</div>
  </div>

  <div class="note ok">
    <strong>âœ… Success!</strong> Your VPC, EKS cluster, databases, and caching layer are now running on AWS. The EKS cluster has both CPU and GPU node groups.
  </div>

  <button class="next-btn" onclick="goStep(4)">Next: Post-Deploy Setup â†’</button>
</div>

<!-- â•â•â• STEP 4: POST-DEPLOY â•â•â• -->
<div class="step container" id="s4">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(236,72,153,0.15);color:var(--accent6)">ğŸ”§</div>
    <div>
      <h2>Step 4 â€” Post-Deployment Configuration</h2>
      <p>Configure kubectl, verify nodes, install GPU drivers</p>
      <span class="time">â± 15 minutes</span>
    </div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Configure kubectl</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Update kubeconfig to point to the new cluster</span>
aws eks update-kubeconfig \
  --name imentora-dev-eks \
  --region ap-south-1

<span class="cm"># Verify connection</span>
kubectl cluster-info
kubectl get nodes

<span class="cm"># Expected: 2 CPU nodes (m5.xlarge) + 1 GPU node (g4dn.xlarge)</span>
<span class="cm"># NAME                                       STATUS   ROLES    AGE</span>
<span class="cm"># ip-10-0-10-xxx.ap-south-1.compute.internal  Ready    <none>   5m   (CPU)</span>
<span class="cm"># ip-10-0-20-xxx.ap-south-1.compute.internal  Ready    <none>   5m   (CPU)</span>
<span class="cm"># ip-10-0-10-yyy.ap-south-1.compute.internal  Ready    <none>   5m   (GPU)</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Verify node types</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Check CPU nodes</span>
kubectl get nodes -l workload-type=general
<span class="cm"># Should show 2 nodes</span>

<span class="cm"># Check GPU nodes</span>
kubectl get nodes -l workload-type=gpu-inference
<span class="cm"># Should show 1 node</span>

<span class="cm"># Check GPU node has NVIDIA taint</span>
kubectl describe node -l workload-type=gpu-inference | grep -A2 "Taints"
<span class="cm"># Taints: nvidia.com/gpu=true:NoSchedule</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Install NVIDIA Device Plugin (GPU support)</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Install NVIDIA device plugin DaemonSet</span>
<span class="cm"># This makes GPU visible to Kubernetes scheduler</span>
kubectl apply -f https://raw.githubusercontent.com/NVIDIA/k8s-device-plugin/v0.14.5/nvidia-device-plugin.yml

<span class="cm"># Wait for it to be running</span>
kubectl -n kube-system get pods -l name=nvidia-device-plugin-ds
<span class="cm"># Should show: nvidia-device-plugin-ds-xxxxx  Running</span>

<span class="cm"># Verify GPU is allocatable</span>
kubectl describe node -l workload-type=gpu-inference | grep nvidia
<span class="cm"># Allocatable:</span>
<span class="cm">#   nvidia.com/gpu: 1</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Create application namespace</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Create namespace for iMentora app</span>
kubectl create namespace imentora-dev

<span class="cm"># Create namespace for monitoring</span>
kubectl create namespace monitoring

<span class="cm"># Create namespace for ArgoCD</span>
kubectl create namespace argocd

<span class="cm"># Verify</span>
kubectl get namespaces</div>
  </div>

  <div class="note ok">
    <strong>âœ… Cluster is ready!</strong> You have a working EKS cluster with CPU + GPU nodes, NVIDIA drivers, and namespaces created.
  </div>

  <button class="next-btn" onclick="goStep(5)">Next: Install K8s Tools â†’</button>
</div>

<!-- â•â•â• STEP 5: K8S TOOLS â•â•â• -->
<div class="step container" id="s5">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(16,185,129,0.15);color:var(--accent4)">ğŸ“¦</div>
    <div>
      <h2>Step 5 â€” Install Kubernetes Platform Tools</h2>
      <p>ArgoCD, ALB Ingress Controller, Monitoring Stack</p>
      <span class="time">â± 20 minutes</span>
    </div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>5a. Install AWS Load Balancer Controller</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Add Helm repo</span>
helm repo add eks https://aws.github.io/eks-charts
helm repo update

<span class="cm"># Install ALB Controller (handles Ingress â†’ ALB mapping)</span>
helm install aws-load-balancer-controller eks/aws-load-balancer-controller \
  -n kube-system \
  --set clusterName=imentora-dev-eks \
  --set serviceAccount.create=true \
  --set serviceAccount.name=aws-load-balancer-controller \
  --set region=ap-south-1 \
  --set vpcId=$(terraform -chdir=environments/dev output -raw vpc_id)

<span class="cm"># Verify</span>
kubectl -n kube-system get deployment aws-load-balancer-controller</div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>5b. Install ArgoCD</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Install ArgoCD</span>
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

<span class="cm"># Wait for pods to be ready</span>
kubectl -n argocd wait --for=condition=Ready pods --all --timeout=300s

<span class="cm"># Get initial admin password</span>
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
echo

<span class="cm"># Port-forward to access UI (temporary)</span>
kubectl -n argocd port-forward svc/argocd-server 8080:443 &
<span class="cm"># Access: https://localhost:8080</span>
<span class="cm"># Username: admin</span>
<span class="cm"># Password: (from command above)</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>5c. Install Monitoring Stack (Prometheus + Grafana)</span><span class="l">Bash</span></div>
    <div class="cmd-b"><span class="cm"># Add Prometheus community Helm repo</span>
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update

<span class="cm"># Install kube-prometheus-stack</span>
helm install monitoring prometheus-community/kube-prometheus-stack \
  -n monitoring \
  --set grafana.adminPassword="imentora-grafana-2024" \
  --set grafana.persistence.enabled=true \
  --set grafana.persistence.size=10Gi \
  --set prometheus.prometheusSpec.retention=15d \
  --set prometheus.prometheusSpec.storageSpec.volumeClaimTemplate.spec.resources.requests.storage=50Gi

<span class="cm"># Port-forward Grafana (temporary)</span>
kubectl -n monitoring port-forward svc/monitoring-grafana 3000:80 &
<span class="cm"># Access: http://localhost:3000</span>
<span class="cm"># Username: admin</span>
<span class="cm"># Password: imentora-grafana-2024</span></div>
  </div>

  <div class="note info">
    <strong>ğŸ’¡ Note:</strong> The port-forward commands are temporary for initial access. Once you set up Ingress resources with your domain (lancieretech.com), ArgoCD and Grafana will be accessible via proper URLs like argocd.lancieretech.com and grafana.lancieretech.com.
  </div>

  <button class="next-btn" onclick="goStep(6)">Next: GitHub CI/CD â†’</button>
</div>

<!-- â•â•â• STEP 6: GITHUB CI/CD â•â•â• -->
<div class="step container" id="s6">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(139,92,246,0.15);color:var(--accent2)">ğŸ”„</div>
    <div>
      <h2>Step 6 â€” Configure GitHub CI/CD</h2>
      <p>Set up GitHub Secrets for automated infrastructure changes</p>
      <span class="time">â± 10 minutes</span>
    </div>
  </div>

  <div class="card">
    <h4>GitHub Repository Secrets to Configure</h4>
    <div class="d">Go to: <strong>github.com/lancier-tech-org/IMENTORA-infra</strong> â†’ Settings â†’ Secrets and variables â†’ Actions</div>
  </div>

  <table class="tbl">
    <thead><tr><th>Secret Name</th><th>Value</th><th>Where to get it</th></tr></thead>
    <tbody>
      <tr><td><code>AWS_ROLE_ARN</code></td><td>GitHub OIDC role ARN</td><td><code>terraform output github_actions_role_arn</code></td></tr>
      <tr><td><code>RDS_USERNAME</code></td><td>RDS master username</td><td>Value of <code>TF_VAR_rds_username</code></td></tr>
      <tr><td><code>RDS_PASSWORD</code></td><td>RDS master password</td><td>Value of <code>TF_VAR_rds_password</code></td></tr>
      <tr><td><code>DOCDB_USERNAME</code></td><td>DocumentDB username</td><td>Value of <code>TF_VAR_docdb_username</code></td></tr>
      <tr><td><code>DOCDB_PASSWORD</code></td><td>DocumentDB password</td><td>Value of <code>TF_VAR_docdb_password</code></td></tr>
      <tr><td><code>REDIS_AUTH_TOKEN</code></td><td>Redis auth token</td><td>Value of <code>TF_VAR_redis_auth_token</code></td></tr>
      <tr><td><code>OPENAI_API_KEY</code></td><td>OpenAI API key</td><td>Your new rotated key</td></tr>
      <tr><td><code>GROQ_API_KEY</code></td><td>Groq API key</td><td>Your new rotated key</td></tr>
    </tbody>
  </table>

  <div class="cmd">
    <div class="cmd-h"><span>Setup GitHub Environments for approvals</span><span class="l">Instructions</span></div>
    <div class="cmd-b"><span class="cm"># In GitHub â†’ IMENTORA-infra â†’ Settings â†’ Environments</span>
<span class="cm"># Create environment: "dev"</span>
<span class="cm">#   â†’ Add required reviewer (your GitHub username)</span>
<span class="cm">#   â†’ This ensures terraform apply requires manual approval</span>

<span class="cm"># Create environment: "dev-plan"</span>
<span class="cm">#   â†’ No reviewers needed (plan is safe to run)</span></div>
  </div>

  <div class="cmd">
    <div class="cmd-h"><span>Push infra code to trigger pipeline</span><span class="l">Bash</span></div>
    <div class="cmd-b">cd IMENTORA-infra
git add .
git commit -m "feat: initial infrastructure setup"
git push origin main

<span class="cm"># Go to GitHub â†’ Actions tab to see the pipeline run</span>
<span class="cm"># Pipeline: Validate â†’ Security Scan â†’ Plan â†’ (manual approve) â†’ Apply</span></div>
  </div>

  <button class="next-btn" onclick="goStep(7)">Next: What's Next â†’</button>
</div>

<!-- â•â•â• STEP 7: NEXT STEPS â•â•â• -->
<div class="step container" id="s7">
  <div class="sh">
    <div class="sh-icon" style="background:rgba(245,158,11,0.15);color:var(--accent3)">ğŸ¯</div>
    <div>
      <h2>Step 7 â€” What's Next</h2>
      <p>Infrastructure is ready â€” now build the deployment pipeline</p>
    </div>
  </div>

  <div class="card" style="border-left: 3px solid var(--accent4);">
    <h4>âœ… What's Done</h4>
    <div class="d">VPC with public/private/database subnets across 2 AZs</div>
    <div class="d">EKS cluster with CPU (m5.xlarge) + GPU (g4dn.xlarge) node groups</div>
    <div class="d">NVIDIA device plugin for GPU workloads</div>
    <div class="d">ECR repository for Docker images</div>
    <div class="d">RDS MySQL for student data (SuperDB)</div>
    <div class="d">DocumentDB for MongoDB (ml_notes)</div>
    <div class="d">ElastiCache Redis for caching</div>
    <div class="d">IAM roles: EKS, nodes, IRSA, GitHub OIDC</div>
    <div class="d">Secrets Manager for API keys</div>
    <div class="d">ArgoCD for GitOps deployments</div>
    <div class="d">Prometheus + Grafana for monitoring</div>
    <div class="d">Terraform CI/CD pipeline with security scanning</div>
  </div>

  <div class="card" style="border-left: 3px solid var(--accent3);">
    <h4>ğŸ“‹ Next: Build in IMENTORA-app Repository</h4>
    <div class="d"><strong>1.</strong> Create production Dockerfile (GPU-enabled with CUDA 12.6)</div>
    <div class="d"><strong>2.</strong> Create CI/CD pipeline (Gitleaks â†’ SonarQube â†’ Trivy â†’ Build â†’ Push to ECR)</div>
    <div class="d"><strong>3.</strong> Update hardcoded IPs (192.168.x.x) to environment variables</div>
    <div class="d"><strong>4.</strong> Update CORS origins for lancieretech.com domain</div>
    <div class="d"><strong>5.</strong> Remove SSL cert handling (ALB manages SSL)</div>
  </div>

  <div class="card" style="border-left: 3px solid var(--accent2);">
    <h4>ğŸ“‹ Next: Build in IMENTORA-gitops Repository</h4>
    <div class="d"><strong>1.</strong> Create Kubernetes manifests (Deployment, Service, Ingress)</div>
    <div class="d"><strong>2.</strong> Configure GPU tolerations + nodeSelector in deployment</div>
    <div class="d"><strong>3.</strong> Create Kustomize overlays for dev/prod</div>
    <div class="d"><strong>4.</strong> Register ArgoCD Application CRDs</div>
    <div class="d"><strong>5.</strong> Set up Ingress with ACM SSL for lancieretech.com</div>
  </div>

  <div class="card" style="border-left: 3px solid var(--accent6);">
    <h4>ğŸ“‹ Next: Data Migration</h4>
    <div class="d"><strong>1.</strong> Export MongoDB data from 192.168.48.201 â†’ Import to DocumentDB</div>
    <div class="d"><strong>2.</strong> Export MySQL/SQL Server data from 192.168.48.199 â†’ Import to RDS</div>
    <div class="d"><strong>3.</strong> Test application connectivity to new database endpoints</div>
  </div>

  <div class="note info">
    <strong>ğŸš€ Ready for the next phase?</strong> Tell me which repo to build next â€” IMENTORA-app (Dockerfile + CI/CD) or IMENTORA-gitops (K8s manifests + ArgoCD), and I'll create the complete structure just like I did for IMENTORA-infra.
  </div>
</div>

<script>
function goStep(n) {
  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.sn').forEach(s => s.classList.remove('active'));
  document.getElementById('s'+n).classList.add('active');
  document.querySelectorAll('.sn')[n].classList.add('active');
  window.scrollTo({top: 0, behavior: 'smooth'});
}
document.querySelectorAll('.sn').forEach(btn => {
  btn.addEventListener('click', () => goStep(parseInt(btn.dataset.s)));
});
</script>
</body>
</html>
